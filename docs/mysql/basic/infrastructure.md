# 基础架构

> 有参考 [](https://time.geekbang.org/column/100020801)

MySQL 可以分为 Server 层和存储引擎层两部分。

Server 层包括连接器、查询缓存、分析器、优化器、执行器等，涵盖 MySQL 的大多数核心服务功能，以及所有的内置函数（如日期、时间、数学和加密函数等），
所有跨存储引擎的功能都在这一层实现，比如存储过程、触发器、视图等。

存储引擎层负责数据的存储和提取。其架构模式是插件式的，支持 InnoDB、MyISAM、Memory 等多个存储引擎。
现在最常用的存储引擎是 InnoDB，它从 MySQL 5.5.5 版本开始成为了默认存储引擎

> 你执行 create table 建表的时候，如果不指定引擎类型，默认使用的就是 InnoDB。

![MySQL 的逻辑架构图](https://cdn.jansora.com/files/uPic/2022/05/23/XvjT8w.jpg)
跟着 **逻辑架构图** , 走一遍整个执行流程， 依次看下每个组件的作用。

## 连接器

连接器负责跟客户端建立连接、获取权限、维持和管理连接。

在完成经典的 TCP 握手后，连接器就要开始认证你的身份，这个时候用的就是你输入的用户名和密码.

- 如果用户名或密码不对，你就会收到一个"Access denied for user"的错误，然后客户端程序结束执行。
- 如果用户名密码认证通过，连接器会到权限表里面查出你拥有的权限。之后，这个连接里面的权限判断逻辑，都将依赖于此时读到的权限。

一个用户成功建立连接后，即使你用管理员账号对这个用户的权限做了修改，也不会影响已经存在连接的权限。修改完成后，只有再新建的连接才会使用新的权限设置。 建立链接的最长时间是 8 小时, 由参数 `wait_timeout` 控制.
